runtime: nodejs10
service: dps-staging
handlers:
  - url: /
    static_files: public/index.html
    upload: public/index.html
    secure: always
    expiration: 1s

  - url: /tracks/([^.]+)
    static_files: public/apply/\1/index.html
    upload: public/apply/([^.]+)/index.html
    secure: always
    expiration: 1s

  - url: /tracks/([^.]+)/
    static_files: public/apply/\1/index.html
    upload: public/apply/([^.]+)/index.html
    secure: always
    expiration: 1s

  # Attention /? won't work to catch both cases
  # path and path/, therefore write them separately
  # matches path/ to path/index.html
  - url: /([^.]+)/
    static_files: public/\1/index.html
    upload: public/([^.]+)/index.html
    secure: always
    expiration: 1s

  # matches path to path/index.html
  - url: /([^.]+)
    static_files: public/\1/index.html
    upload: public/([^.]+)/index.html
    secure: always
    expiration: 1s

  # matches path/other/ to path/other/index.html
  - url: /([^.]+)/([^.]+)/
    static_files: public/\1/\2/index.html
    upload: public/([^.]+)/([^.]+)/index.html
    secure: always
    expiration: 1s

  # matches path/other to path/other/index.html
  - url: /([^.]+)/([^.]+)
    static_files: public/\1/\2/index.html
    upload: public/([^.]+)/([^.]+)/index.html
    secure: always
    expiration: 1s

  # catch everything else
  - url: /(.*)
    static_files: public/\1
    upload: public/(.*)
    secure: always
    expiration: 1s

default_expiration: 1s
